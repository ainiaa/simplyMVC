这个实现太复杂了，而且没有实现读写分离